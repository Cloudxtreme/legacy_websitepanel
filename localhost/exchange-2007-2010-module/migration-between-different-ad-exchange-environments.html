<!DOCTYPE html> 
<html lang="en" class="static orchard-blogs"> 

<!-- Mirrored from localhost/exchange-2007-2010-module/migration-between-different-ad-exchange-environments by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 12 Nov 2013 19:11:37 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head> 
    <meta charset="utf-8" />
    <title>Migration between different AD/Exchange environments - WebsitePanel</title> 
    <link href="../Modules/Orchard.Localization/Styles/orchard-localization-base.css" rel="stylesheet" type="text/css" />
<link href="../Themes/WebsitePanel/Styles/Site.css" rel="stylesheet" type="text/css" />
<meta content="Orchard" name="generator" />
<link href="../modules/orchard.themes/Content/orchard.ico" rel="shortcut icon" type="image/x-icon" />
<link href="http://fonts.googleapis.com/css?family=Lobster&amp;subset=latin" rel="stylesheet" type="text/css" />
<script src="../Core/Shapes/scripts/html5.js" type="text/javascript"></script>

<link rel="alternate" type="application/rss+xml" title="Exchange 2007/2010 Module" href="../rss68ec?containerid=101" />

<link rel="alternate" type="application/rss+xml" title="Exchange 2007/2010 Module - Comments" href="../rssba67?commentedoncontainer=101" />

    <script>(function(d){d.className="dyn"+d.className.substring(6,d.className.length);})(document.documentElement);</script> 
</head> 
<body>


<div class="split-4" id="layout-wrapper">
<header id="layout-header" class="group">
    <div id="header">
        <div class="zone zone-header"><h1 id="branding"><a href="../index.html" title="WebsitePanel"></a></h1>

<div id="search">
    <form action="http://localhost/search">
        <input type="text" name="q" />
        <input type="submit" id="search" value="Search" />
    </form>
</div></div>
    </div>
</header>
<div id="layout-navigation" class="group">
    <div class="zone zone-navigation"><nav>
    <ul class="menu menu-main">
        
        <li>    <a href="../index.html">Home</a>
</li><li>    <a href="../whatsnew.html">What&#39;s new?</a>
</li><li>    <a href="../license.html">License</a>
</li><li>    <a href="../downloads.html">Downloads</a>
</li><li>    <a href="../demo.html">Demo</a>
</li><li>    <a href="../documentation.html">Documentation</a>
</li><li>    <a href="../works-with.html">Works With</a>
</li><li>    <a href="../contact-us.html">Contact Us</a>
</li>
    </ul>
</nav></div>
</div>
<div id="layout-before-main" class="group">
    <div class="zone zone-before-main"><article class="widget-html-widget widget">
    <p><a href="../documentation.html">Documentation</a> &gt;&nbsp;<a href="index.html">Exchange 2007/2010 Modules</a></p>
</article></div>
</div>
<div id="layout-main-container">
<div id="layout-main" class="group">
    <div id="layout-content" class="group">
        <div id="content" class="group">
            <div class="zone zone-content"><article class="content-item blog-post">
    <header>
        <h1>Migration between different AD/Exchange environments</h1>

        <div class="metadata">
            
        </div>
    </header>
    <div class="content-localization">
    <div class="content-localizations">
        <h4>Translations:</h4>
        <ul class="localizations"><li class="first last"><a href="migration-between-different-ad-exchange-environments-tr-TR.html">tr-TR</a></li></ul>
    </div>
</div>
<h2>General idea </h2> <p>The main idea is to move mailbox data from old AD/Exchange infrastructure to the new one using the steps below:  <ul> <li>re-create user accounts and mailboxes on new server  <li>export old mailbox data to pst files from old AD/Exchange infrastructure  <li>import mailbox data to new AD/Exchange infrastructure</li></ul> <p>Every step could be done manually or using some automation utility. We do not provide automated solution for the entire process. While it is possible to "big-bang" solution in theory, it is better to do it carefully, half-manually, step-by-step, organization-by-organization, with checkpoints after every step.  <p><a name="Section2"></a> <h2>Steps to move users within one organization </h2> <ul> <li>Inform users about time when they should not create new mailboxes and time when actual mailbox movement scheduled.  <li>Create new organization in WSP based on appropriate Hosting Plan/Hosting Space.  <li>Exchange-enable organization by creating and deleting test mailbox in it.  <li>Add organization's domains to newly created Organization  <li>Set organization's domains as Internal Relay Domains according to this <a href="http://technet.microsoft.com/en-us/library/bb124423.aspx">http://technet.microsoft.com/en-us/library/bb124423.aspx</a> article and create connector for messages to non-existing recipients in organization's domains to be forwarded to old Exchange system  <li>Test that mail to non-existing recipients in organization's domains successfully forwarded to old Exchange system. For this send test mail to recipient whose mailbox is on old Exchange system to new Exchange system with telnet. Read this <a href="http://technet.microsoft.com/en-us/library/bb123686.aspx">http://technet.microsoft.com/en-us/library/bb123686.aspx</a> article about how to use telnet to test SMTP communication  <li>After successfull test change DNS MX record for organization's domains to new Exchange system.  <li>Create all mailboxes in WSP for that organization with the same e-mail address (addresses). Use simple standard password for all mailboxes. You can use <a href="Using-bulk-import-tool.html">Bulk Import Tool</a> to automate this process.  <li>Create all Organization's Public Folders.  <li>Additionally inform users about time when actual mailbox movement scheduled and ask them not to use mailboxes at that time.  <li> <p>Reset password for every organization's user on <strong>old</strong> system to prevent them from connecting there anymore. </p> <li> <p>Connect to every organization's mailbox with Outlook and export it to pst file. This step can be automated with exmerge tool for Exchange 2000/2003 (<a href="http://msexchangeteam.com/archive/2004/07/01/171051.aspx">http://msexchangeteam.com/archive/2004/07/01/171051.aspx</a>) or export-mailbox (<a href="http://msexchangeteam.com/archive/2007/04/13/437745.aspx">http://msexchangeteam.com/archive/2007/04/13/437745.aspx</a>) tool for Exchange 2007. </p> <li> <p>Use one of mailboxes to connect to organization's Public Folders and export them to pst files too. </p> <li> <p>Make note what language is used in what mailbox. It can be done in pst file name. For example user_customer_en.pst </p> <li> <p>Set Autodiscover/OWA redirect DNS records in organization's domains to make Outlook/OWA connection easier. </p> <li> <p>Connect to every mailbox with OWA with appropriate default Internet Explorer language. This will create correct default folders in correct language. </p> <li> <p>Connect to every organization's mailbox with Outlook. Use Outlook to import pst files to mailboxes. Also you can use import-mailbox command let for that task (<a href="http://msexchangeteam.com/archive/2007/04/13/437745.aspx">http://msexchangeteam.com/archive/2007/04/13/437745.aspx</a>). </p> <li> <p>Import Public Folders using Outlook. </p> <li> <p>Copy legacyExchangeDN attribute from <strong>old </strong>AD to newly create X500 address for every user. You can use csvde utility to retrieve legacyExchangeDN attributes. This is needed to replies to <strong>old</strong> internal mails works. Additional information could be found here <a href="http://support.microsoft.com/kb/555197/en-us">http://support.microsoft.com/kb/555197/en-us</a>. </p> <li> <p>Disable users in <strong>old</strong> AD. </p> <li> <p>Change organization's domains type back to default Accepted Domains. </p> <li> <p>Instruct users how to connect to new server and how to change passwords. </p></li></ul><a name="Section3"></a> <h2>Alternative way. Note that it was not tested in WSP lab. </h2> <ul> <li>Create temporary OU for moved organization.  <li>Move mailboxes between forests according to <a href="http://msexchangeteam.com/archive/2006/11/02/430289.aspx">http://msexchangeteam.com/archive/2006/11/02/430289.aspx</a>. Use temporary OU as target.  <li>Follow "<a href="migration-inside-one-existing-ad-exchange-environment.html">Migration inside one existing AD/Exchange environment</a>". <li>Delete temporary OU.  <li>Do not skip or replace other steps.</li></ul>
</article></div>
        </div>
    </div>
</div>
</div>
<div id="layout-footer" class="group">
    <footer id="footer">
        <div id="footer-quad" class="group">
            <div id="footer-quad-fourth">
                <div class="zone zone-footer-quad-fourth"><article class="widget-html-widget widget">
    <center><span style="font-family: arial;" face="arial"><a href="../index.html">Home</a>&nbsp;&nbsp;&nbsp;&nbsp; <a href="../license.html">License</a>&nbsp;&nbsp;&nbsp;&nbsp; <a href="../whatsnew.html">What's new?</a>&nbsp;&nbsp;&nbsp;&nbsp; <a href="../contact-us.html">Contact Us</a>&nbsp;&nbsp;&nbsp;&nbsp; <a href="../privacy-policy/privacy-policy.html">Privacy Policy</a>&nbsp;&nbsp;&nbsp;&nbsp; <a href="../terms-of-use/terms-of-use.html">Terms of Use</a> </span></center>
</article></div>
            </div>
        </div>
        <div id="footer-sig" class="group">
            <div class="zone zone-footer">    <div class="credits"><span class="poweredby">Powered by <a href="http://www.orchardproject.net/" target="_blank">Orchard</a></span> <span class="copyright">&#169; 2011 Outercurve Foundation</span></div>
<div class="user-display">
        <span class="user-actions"><a href="../Users/Account/LogOn7fed.html?ReturnUrl=%2Fexchange-2007-2010-module%2Fmigration-between-different-ad-exchange-environments">Sign In</a></span>
</div></div>
        </div>
    </footer>
</div>
</div>

</body>

<!-- Mirrored from localhost/exchange-2007-2010-module/migration-between-different-ad-exchange-environments by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 12 Nov 2013 19:11:39 GMT -->
</html>